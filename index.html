<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR Pro Dashboard</title>
    <script>console.log('ðŸ”¥ CANARY: JavaScript engine is working!');</script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- PDF Library Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.6.0/jspdf.plugin.autotable.min.js"></script>
    <!-- Flatpickr Date Picker -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Authentication Container -->
    <div id="auth-container" class="flex items-center justify-center min-h-screen">
        <div class="glass-effect rounded-3xl p-10 max-w-md w-full">
            <!-- Login Form -->
            <div id="login-form" class="auth-form-container">
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-white mb-2">Welcome back</h1>
                    <p class="text-gray-400">Please enter your details to sign in.</p>
                </div>
                
                <form id="login-form-element" class="mt-8">
                    <div class="space-y-6">
                        <div>
                            <label class="text-sm font-medium text-gray-400" for="login-email">Email</label>
                            <div class="relative mt-1">
                                <input 
                                    class="input-field block w-full rounded-lg border-transparent p-4 pr-12 text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                    id="login-email" 
                                    type="email" 
                                    placeholder="Enter your email"
                                    autocomplete="email"
                                    required
                                />
                                <button type="submit" class="absolute inset-y-0 right-0 flex items-center justify-center w-10 h-full text-white bg-blue-600 hover:bg-blue-700 rounded-r-lg">
                                    <span class="material-icons text-sm">arrow_forward</span>
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <label class="text-sm font-medium text-gray-400" for="login-password">Password</label>
                            <div class="relative mt-1">
                                <input 
                                    class="input-field block w-full rounded-lg border-transparent p-4 text-white placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-transparent" 
                                    id="login-password" 
                                    type="password" 
                                    placeholder="Enter your password"
                                    autocomplete="current-password"
                                    required
                                />
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex items-center mt-6">
                        <input class="h-4 w-4 rounded border-gray-600 bg-gray-700 text-blue-600 focus:ring-blue-500" id="remember-me" name="remember-me" type="checkbox"/>
                        <label class="ml-2 block text-sm text-gray-300" for="remember-me">Remember me</label>
                    </div>
                </form>

                <div class="relative flex py-5 items-center">
                    <div class="flex-grow border-t border-gray-600"></div>
                    <span class="flex-shrink mx-4 text-gray-400 text-sm">OR</span>
                    <div class="flex-grow border-t border-gray-600"></div>
                </div>

                <div class="space-y-4">
                    <button id="google-login-btn" class="w-full flex items-center justify-between p-4 rounded-lg input-field text-white hover:bg-gray-700 transition-colors">
                        <div class="flex items-center">
                            <img alt="Google logo" class="w-5 h-5 mr-3" src="https://lh3.googleusercontent.com/aida-public/AB6AXuC1OdtLI4jjgGCIiZLn5Sbp9nfVGb-lWvLxmG9XzEsgFQdUSZAziqSd2KvO0_3oKm7OsqSZ_4bWJV0MT3SB_Cfu3W_A5PhuOCfu60geyLvXYEgemcOcEBstX1XTdLTKLqosMfIQk5gElsVW2ql2xMM56KUrCxTsaMqsTeZr5wElGC_MOdow14YH4ADDbPCjtu5nkcPq-0cMfSxkGd0UHDDcqB-IhXMC41ShITho9C0XqkpdaHYCGHDIIa8JdZ7mKm7v93gQeWE9rw"/>
                            Continue with Google
                        </div>
                        <span class="material-icons text-gray-400">arrow_forward</span>
                    </button>
                </div>

                <div class="mt-8 text-center">
                    <p class="text-sm text-gray-400">
                        Don't have an account?
                        <a class="font-medium underline gradient-text cursor-pointer" id="show-signup">Create Account</a>
                    </p>
                </div>
            </div>

            <!-- Sign Up Form -->
            <div id="signup-form" class="auth-form-container signup-variant" style="display: none;">
                <div class="text-center">
                    <h1 class="text-3xl font-bold text-white mb-2">Join OCR Pro</h1>
                    <p class="text-gray-400">Create your account and start processing documents.</p>
                </div>
                
                <form id="signup-form-element" class="mt-8">
                    <div class="space-y-6">
                        <div>
                            <label class="text-sm font-medium text-gray-400" for="signup-email">Email</label>
                            <div class="relative mt-1">
                                <input 
                                    class="input-field block w-full rounded-lg border-transparent p-4 pr-12 text-white placeholder-gray-500 focus:ring-2 focus:ring-purple-500 focus:border-transparent" 
                                    id="signup-email" 
                                    type="email" 
                                    placeholder="Enter your email"
                                    autocomplete="email"
                                    required
                                />
                                <button type="submit" class="absolute inset-y-0 right-0 flex items-center justify-center w-10 h-full text-white bg-purple-600 hover:bg-purple-700 rounded-r-lg">
                                    <span class="material-icons text-sm">arrow_forward</span>
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <label class="text-sm font-medium text-gray-400" for="signup-password">Password</label>
                            <div class="relative mt-1">
                                <input 
                                    class="input-field block w-full rounded-lg border-transparent p-4 text-white placeholder-gray-500 focus:ring-2 focus:ring-purple-500 focus:border-transparent" 
                                    id="signup-password" 
                                    type="password" 
                                    placeholder="Create a password (min 6 characters)"
                                    autocomplete="new-password"
                                    minlength="6"
                                    required
                                />
                            </div>
                        </div>
                    </div>
                </form>

                <div class="relative flex py-5 items-center">
                    <div class="flex-grow border-t border-gray-600"></div>
                    <span class="flex-shrink mx-4 text-gray-400 text-sm">OR</span>
                    <div class="flex-grow border-t border-gray-600"></div>
                </div>

                <div class="space-y-4">
                    <button id="google-signup-btn" class="w-full flex items-center justify-between p-4 rounded-lg input-field text-white hover:bg-gray-700 transition-colors">
                        <div class="flex items-center">
                            <img alt="Google logo" class="w-5 h-5 mr-3" src="https://lh3.googleusercontent.com/aida-public/AB6AXuC1OdtLI4jjgGCIiZLn5Sbp9nfVGb-lWvLxmG9XzEsgFQdUSZAziqSd2KvO0_3oKm7OsqSZ_4bWJV0MT3SB_Cfu3W_A5PhuOCfu60geyLvXYEgemcOcEBstX1XTdLTKLqosMfIQk5gElsVW2ql2xMM56KUrCxTsaMqsTeZr5wElGC_MOdow14YH4ADDbPCjtu5nkcPq-0cMfSxkGd0UHDDcqB-IhXMC41ShITho9C0XqkpdaHYCGHDIIa8JdZ7mKm7v93gQeWE9rw"/>
                            Continue with Google
                        </div>
                        <span class="material-icons text-gray-400">arrow_forward</span>
                    </button>
                </div>

                <div class="mt-8 text-center">
                    <p class="text-sm text-gray-400">
                        Already have an account?
                        <a class="font-medium underline gradient-text cursor-pointer" id="show-login">Sign in here</a>
                    </p>
                </div>
            </div>

            <!-- Auth Message -->
            <div id="auth-message" class="auth-message mt-4"></div>
        </div>
    </div>

    <!-- Dashboard Container -->
    <div class="dashboard-container" style="display: none;">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">description</span>OCR Pro
                </div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-page-id="page-dashboard">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">dashboard</span>Dashboard
                </div>
                <div class="nav-item" data-page-id="page-business-cards">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">business_center</span>Business Cards
                </div>
                <div class="nav-item" data-page-id="page-invoices">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">receipt</span>Invoices
                </div>
                <div class="nav-item" data-page-id="page-settings">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">settings</span>Settings
                </div>
                <div class="nav-item" data-page-id="page-billing">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">payment</span>Billing
                </div>
                <div class="nav-item" data-page-id="page-create-table">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">add_box</span>Create Table
                </div>
                <div class="nav-item" data-page-id="upload-modal">
                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">cloud_upload</span>Upload
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div>
                    <h1 class="header-title" id="page-title">Dashboard</h1>
                    <p class="header-subtitle" id="page-subtitle">Monitor your document processing activity</p>
                </div>
                <div class="header-actions">
                    <!-- Theme Toggle Button -->
                    <div class="header-theme-toggle">
                        <input type="checkbox" id="header-theme-toggle" style="display: none;">
                        <label for="header-theme-toggle" class="theme-toggle-btn">
                            <span class="material-icons">light_mode</span>
                        </label>
                    </div>
                    <div class="user-profile">
                        <div class="user-avatar">ðŸ‘¤</div>
                        <span id="user-email">Loading...</span>
                        <button id="logout-btn" class="logout-btn">Logout</button>
                    </div>
                </div>
            </header>

            <!-- Dashboard Page Content -->
            <div id="page-dashboard" class="page-content">
                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: #9D76F820; color: #9D76F8;"><span class="material-icons" style="font-size: 1.8rem;">description</span></div>
                        </div>
                        <div class="stat-number" id="stat-docs-processed">0</div>
                        <div class="stat-label">Documents Processed</div>
                        <div class="stat-trend trend-up">â†— +12% from last month</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: #10b98120; color: #10b981;"><span class="material-icons" style="font-size: 1.8rem;">business_center</span></div>
                        </div>
                        <div class="stat-number" id="stat-business-cards">0</div>
                        <div class="stat-label">Business Cards</div>
                        <div class="stat-trend trend-up">â†— +18% from last month</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: #f59e0b20; color: #f59e0b;"><span class="material-icons" style="font-size: 1.8rem;">receipt</span></div>
                        </div>
                        <div class="stat-number" id="stat-invoices">0</div>
                        <div class="stat-label">Invoices</div>
                        <div class="stat-trend trend-up">â†— +8% from last month</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon" style="background: #8b5cf620; color: #8b5cf6;"><span class="material-icons" style="font-size: 1.8rem;">speed</span></div>
                        </div>
                        <div class="stat-number" id="stat-accuracy-rate">99.2%</div>
                        <div class="stat-label">Accuracy Rate</div>
                        <div class="stat-trend trend-up">â†— +0.3% from last month</div>
                    </div>
                </div>

                <!-- Usage Chart -->
                <div class="usage-chart">
                    <div class="chart-header">
                        <h3 class="chart-title">Monthly Usage</h3>
                        <span style="color: #94a3b8;">Pro Plan - 10,000 pages/month</span>
                    </div>
                    <div class="usage-bar">
                        <div class="usage-fill" style="width: 34.7%;"></div>
                    </div>
                    <div class="usage-stats">
                        <span>3,470 / 10,000 pages used</span>
                        <span>65.3% remaining</span>
                    </div>
                </div>

                <!-- Value Proposition Section -->
                <div class="dashboard-value-proposition">
                    <h3 class="value-section-title">Your OCR Value Impact</h3>
                    <p class="calculation-note">Based on an average of 4 minutes per document and a $15/hr labor cost.</p>
                    <div class="dashboard-value-cards">
                        <div class="dashboard-value-card time-saved">
                            <div class="value-icon">
                                <span class="material-icons">schedule</span>
                            </div>
                            <div class="value-content">
                                <div class="dashboard-value-number" id="dashboard-hours-saved">~0 Hours</div>
                                <div class="value-label">Time Saved</div>
                            </div>
                        </div>
                        <div class="dashboard-value-card money-saved">
                            <div class="value-icon">
                                <span class="material-icons">attach_money</span>
                            </div>
                            <div class="value-content">
                                <div class="dashboard-value-number" id="dashboard-value-created">~$0</div>
                                <div class="value-label">Value Created</div>
                            </div>
                        </div>
                        <div class="dashboard-value-card roi-card">
                            <div class="value-icon">
                                <span class="material-icons">trending_up</span>
                            </div>
                            <div class="value-content">
                                <div class="dashboard-value-number" id="dashboard-roi">0%</div>
                                <div class="value-label">Return on Investment</div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="quick-action full-width" id="upload-area-button">
                        <div class="quick-action-icon"><span class="material-icons" style="font-size: 2.5rem;">cloud_upload</span></div>
                        <div class="quick-action-title">Upload Documents</div>
                        <div class="quick-action-desc">Process new files</div>
                    </div>
                </div>
            </div>

            <!-- Business Cards Page Content -->
            <div id="page-business-cards" class="page-content" style="display: none;">
                <!-- Recent Business Cards -->
            <div class="data-section">
                <div class="data-header">
                    <h3 class="data-title">Recent Business Cards</h3>
                    <div class="data-controls">
                        <input type="text" class="search-box business_cards-search" id="contacts-search" placeholder="Search contacts...">
                        <input type="text" class="search-box business_cards-date-range" id="contacts-date-range" placeholder="Select date range..." readonly style="width: 200px;">
                        <button type="button" class="btn btn-secondary business_cards-clear-btn" title="Clear Filters">Clear</button>
                        <div class="search-loading business_cards-loading" style="display: none;">
                            <span class="loading-spinner"></span>
                        </div>
                        <button class="btn btn-accent upload-to-table-btn" data-table="business_cards" style="margin-right: 8px;">
                            <span class="material-icons">cloud_upload</span>
                            Upload
                        </button>
                        <button class="btn btn-primary" id="export-vcf-btn">Export Selected VCF</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="select-all-contacts"></th>
                                <th>Name</th>
                                <th>Job Position</th>
                                <th>Company</th>
                                <th>Phone</th>
                                <th>Email</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="contacts-table-body">
                        </tbody>
                    </table>
                </div>
            </div>

            </div>

            <!-- Invoices Page Content -->
            <div id="page-invoices" class="page-content" style="display: none;">
                <!-- Recent Invoices -->
                <div class="data-section">
                <div class="data-header">
                    <h3 class="data-title">Recent Invoices</h3>
                    <div class="data-controls">
                        <input type="text" class="search-box invoices-search" id="invoices-search" placeholder="Search invoices...">
                        <input type="text" class="search-box invoices-date-range" id="invoices-date-range" placeholder="Select date range..." readonly style="width: 200px;">
                        <button type="button" class="btn btn-secondary invoices-clear-btn" title="Clear Filters">Clear</button>
                        <div class="search-loading invoices-loading" style="display: none;">
                            <span class="loading-spinner"></span>
                        </div>
                        <button class="btn btn-accent upload-to-table-btn" data-table="invoices" style="margin-right: 8px;">
                            <span class="material-icons">cloud_upload</span>
                            Upload
                        </button>
                        <select id="invoice-export-format">
                            <option value="csv">Export as CSV</option>
                            <option value="pdf">Export as PDF</option>
                        </select>
                        <button class="btn btn-primary" id="handle-invoice-export-btn">Export Selected</button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="select-all-invoices"></th>
                                <th>Invoice #</th>
                                <th>Supplier</th>
                                <th>Product</th>
                                <th>Loading Port</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="invoices-table-body">
                        </tbody>
                    </table>
                </div>
            </div>
            </div>

            <!-- Settings Page Content -->
            <div id="page-settings" class="page-content" style="display: none;">
                <div class="settings-container">
                    <!-- Settings Header -->
                    <div class="settings-header">
                        <h2>Settings</h2>
                        <p>Customize your OCR Pro experience and manage your account</p>
                    </div>

                    <!-- Settings Grid Layout -->
                    <div class="settings-grid">
                        
                        <!-- Appearance Section -->
                        <div class="settings-card">
                            <h3>
                                <span class="material-icons">palette</span>
                                Appearance
                            </h3>
                            <div class="setting-item">
                                <label>Theme Preference</label>
                                <div class="theme-toggle">
                                    <input type="checkbox" id="theme-toggle">
                                    <label for="theme-toggle" class="toggle-switch">
                                        <span class="dark-label">Dark</span>
                                        <span class="light-label">Light</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Profile Management Section -->
                        <div class="settings-card">
                            <h3>
                                <span class="material-icons">person</span>
                                Profile
                            </h3>
                            <!-- COMMENTED OUT - Display Name Change
                            <form id="profile-form">
                                <div class="form-group">
                                    <label for="display-name">Display Name</label>
                                    <input type="text" id="display-name" placeholder="Your display name">
                                </div>
                                <button type="submit" class="btn btn-primary">Update Profile</button>
                            </form>
                            
                            <hr style="border: none; height: 1px; background: var(--border-primary); margin: 24px 0; opacity: 0.3;">
                            -->
                            
                            <!-- Password Change Section -->
                            <div class="password-change-section">
                                <button type="button" class="btn btn-secondary" id="show-password-form">
                                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px; font-size: 1rem;">lock</span>
                                    Change Password
                                </button>
                                
                                <form id="password-form" style="display: none; margin-top: 16px;">
                                    <div class="form-group">
                                        <label for="current-password">Current Password</label>
                                        <input type="password" id="current-password" placeholder="Enter current password">
                                    </div>
                                    <div class="form-group">
                                        <label for="new-password">New Password</label>
                                        <input type="password" id="new-password" placeholder="Enter new password (min 6 characters)" minlength="6">
                                    </div>
                                    <div style="display: flex; gap: 12px;">
                                        <button type="submit" class="btn btn-primary">Update Password</button>
                                        <button type="button" class="btn btn-secondary" id="cancel-password-form">Cancel</button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- COMMENTED OUT - Preferences Section
                        <div class="settings-card">
                            <h3>
                                <span class="material-icons">tune</span>
                                Preferences
                            </h3>
                            <div class="setting-item">
                                <label for="default-doc-type">Default Document Type</label>
                                <select id="default-doc-type">
                                    <option value="">Choose a default type...</option>
                                    <option value="business_cards">Business Cards</option>
                                    <option value="invoices">Invoices</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="email-notifications" style="width: auto; margin-right: 8px;">
                                    Email notifications for completed processing
                                </label>
                            </div>
                            <div class="setting-item">
                                <label>
                                    <input type="checkbox" id="auto-save-enabled" style="width: auto; margin-right: 8px;">
                                    Auto-save extracted data
                                </label>
                            </div>
                        </div>
                        -->

                        <!-- Account Information Section -->
                        <div class="settings-card">
                            <h3>
                                <span class="material-icons">info</span>
                                Account Information
                            </h3>
                            <div class="setting-item">
                                <label>Email Address</label>
                                <input type="email" id="user-email-display" readonly style="background: var(--bg-quaternary); cursor: not-allowed;">
                            </div>
                            <div class="setting-item">
                                <label>Account Created</label>
                                <input type="text" id="account-created" readonly style="background: var(--bg-quaternary); cursor: not-allowed;">
                            </div>
                            <div class="setting-item">
                                <label>Plan</label>
                                <input type="text" value="Pro Plan - 10,000 pages/month" readonly style="background: var(--bg-quaternary); cursor: not-allowed;">
                            </div>
                        </div>

                        <!-- Danger Zone Section -->
                        <div class="settings-card">
                            <h3>
                                <span class="material-icons">warning</span>
                                Danger Zone
                            </h3>
                            <div class="setting-item">
                                <label>Delete Account</label>
                                <p style="font-size: 0.9rem; color: var(--text-secondary); margin: 8px 0;">This action cannot be undone. All your data will be permanently deleted.</p>
                                <button class="btn btn-danger" id="delete-account-btn">Delete Account</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- Billing Page Content -->
            <div id="page-billing" class="page-content" style="display: none;">
                <div class="billing-container">
                    
                    <!-- Section 1: Current Plan & Usage -->
                    <div class="billing-section current-plan-section">
                        <h2>Current Plan & Usage</h2>
                        <div class="plan-usage-grid">
                            <div class="current-plan-card">
                                <div class="plan-header">
                                    <h3 id="current-plan-name">Loading...</h3>
                                    <span class="plan-badge" id="plan-status-badge">Active</span>
                                </div>
                                <p id="current-plan-details">Loading plan details...</p>
                                <div class="plan-meta">
                                    <span id="plan-price">Loading...</span>
                                    <span id="plan-billing-cycle">Loading...</span>
                                </div>
                            </div>
                            <div class="usage-chart">
                                <div class="chart-header">
                                    <h3 class="chart-title">Monthly Usage</h3>
                                    <span id="billing-plan-info" style="color: #94a3b8;">Loading...</span>
                                </div>
                                <div class="usage-bar">
                                    <div class="usage-fill" id="billing-usage-fill" style="width: 0%;"></div>
                                </div>
                                <div class="usage-stats">
                                    <span id="billing-usage-text">Loading...</span>
                                    <span id="billing-usage-remaining">Loading...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 3: Plan Comparison -->
                    <div class="billing-section plan-comparison-section">
                        <h2>Choose Your Plan</h2>
                        <div class="plans-grid">
                            
                            <!-- Trial Plan -->
                            <div class="plan-card trial-plan" data-plan="trial">
                                <div class="plan-header">
                                    <h3>Trial</h3>
                                    <div class="plan-badge trial-badge">Limited Time</div>
                                </div>
                                <div class="plan-price">
                                    <span class="price-amount">Free</span>
                                </div>
                                <div class="plan-features">
                                    <div class="plan-feature">
                                        <span class="material-icons">check</span>
                                        <span>50 pages total</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">schedule</span>
                                        <span>7 days trial</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">support</span>
                                        <span>Basic support</span>
                                    </div>
                                </div>
                                <button class="plan-button trial-button" data-plan="trial" disabled>Current Plan</button>
                            </div>
                            
                            <!-- Starter Plan -->
                            <div class="plan-card starter-plan" data-plan="starter">
                                <div class="plan-header">
                                    <h3>Starter</h3>
                                    <div class="plan-badge popular-badge">Most Popular</div>
                                </div>
                                <div class="plan-price">
                                    <span class="price-amount">$12.99</span>
                                    <span class="price-period">/month</span>
                                </div>
                                <div class="plan-features">
                                    <div class="plan-feature">
                                        <span class="material-icons">check</span>
                                        <span>500 pages/month</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">groups</span>
                                        <span>Perfect for small teams</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">support_agent</span>
                                        <span>Priority support</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">cloud_download</span>
                                        <span>Export capabilities</span>
                                    </div>
                                </div>
                                <button class="plan-button upgrade-button" data-plan="starter">Upgrade Plan</button>
                            </div>
                            
                            <!-- Business Plan -->
                            <div class="plan-card business-plan" data-plan="business">
                                <div class="plan-header">
                                    <h3>Business</h3>
                                    <div class="plan-badge enterprise-badge">Enterprise</div>
                                </div>
                                <div class="plan-price">
                                    <span class="price-amount">$79.99</span>
                                    <span class="price-period">/month</span>
                                </div>
                                <div class="plan-features">
                                    <div class="plan-feature">
                                        <span class="material-icons">check</span>
                                        <span>5,000 pages/month</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">analytics</span>
                                        <span>Advanced analytics</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">security</span>
                                        <span>Priority security</span>
                                    </div>
                                    <div class="plan-feature">
                                        <span class="material-icons">api</span>
                                        <span>API access</span>
                                    </div>
                                </div>
                                <button class="plan-button upgrade-button" data-plan="business">Upgrade Plan</button>
                            </div>
                            
                            <!-- Pay As You Go Plan -->
                            <div class="plan-card payg-plan" data-plan="pay_as_you_go">
                                <div class="plan-header">
                                    <h3>Pay As You Go</h3>
                                    <div class="plan-badge flexible-badge">Flexible</div>
                                </div>
                                <div class="plan-price">
                                    <span class="price-amount">Top-Up</span>
                                </div>
                                <div class="topup-options">
                                    <div class="topup-option" data-pages="100" data-price="500">
                                        <div class="topup-info">
                                            <span class="topup-pages">100 pages</span>
                                            <span class="topup-price">$5.00</span>
                                        </div>
                                        <button class="btn btn-sm topup-button">Purchase</button>
                                    </div>
                                    <div class="topup-option" data-pages="500" data-price="2000">
                                        <div class="topup-info">
                                            <span class="topup-pages">500 pages</span>
                                            <span class="topup-price">$20.00</span>
                                        </div>
                                        <button class="btn btn-sm topup-button">Purchase</button>
                                    </div>
                                    <div class="topup-option" data-pages="1000" data-price="3500">
                                        <div class="topup-info">
                                            <span class="topup-pages">1,000 pages</span>
                                            <span class="topup-price">$35.00</span>
                                        </div>
                                        <button class="btn btn-sm topup-button">Purchase</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 4: Payment & Subscription Management -->
                    <div class="billing-section payment-section">
                        <h2>Payment & Subscription Management</h2>
                        
                        <div class="payment-grid">
                            <div class="payment-method-card">
                                <div class="card-header">
                                    <h3>
                                        <span class="material-icons">credit_card</span>
                                        Payment Method
                                    </h3>
                                </div>
                                <div class="current-payment-method">
                                    <div class="payment-info">
                                        <span class="material-icons">credit_card</span>
                                        <span id="payment-method-display">No payment method on file</span>
                                    </div>
                                </div>
                                <button class="btn btn-primary" id="update-payment-btn">
                                    <span class="material-icons" style="vertical-align: middle; margin-right: 8px; font-size: 1rem;">edit</span>
                                    Update Payment Method
                                </button>
                            </div>
                            
                            <div class="subscription-actions-card">
                                <div class="card-header">
                                    <h3>
                                        <span class="material-icons">manage_accounts</span>
                                        Subscription Actions
                                    </h3>
                                </div>
                                <div class="action-buttons">
                                    <button class="btn btn-secondary" id="manage-subscription-btn">
                                        <span class="material-icons" style="vertical-align: middle; margin-right: 8px; font-size: 1rem;">settings</span>
                                        Manage Subscription
                                    </button>
                                </div>
                                <div class="danger-zone">
                                    <h4>
                                        <span class="material-icons">warning</span>
                                        Danger Zone
                                    </h4>
                                    <p>Canceling your subscription will downgrade you to the trial plan at the end of your billing cycle.</p>
                                    <button class="btn btn-danger" id="cancel-subscription-btn">
                                        <span class="material-icons" style="vertical-align: middle; margin-right: 8px; font-size: 1rem;">cancel</span>
                                        Cancel Subscription
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stripe-disclaimer">
                            <div class="disclaimer-icon">
                                <span class="material-icons">security</span>
                            </div>
                            <div class="disclaimer-content">
                                <p><strong>Security Notice:</strong> Your payment details are managed securely by our payment partner, Stripe. We never store sensitive card information on our systems.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Create Custom Table Page Content -->
            <div id="page-create-table" class="page-content" style="display: none;">
                <div class="create-table-container">
                    <div class="create-table-header">
                        <h2>Create Custom Table</h2>
                        <p>Define a new document type with custom fields to organize your documents</p>
                    </div>

                    <form id="create-table-form" class="create-table-form">
                        <!-- Table Basic Info Section -->
                        <div class="form-section">
                            <h3>Table Information</h3>
                            <div class="form-group">
                                <label for="table-display-name">Display Name *</label>
                                <input 
                                    type="text" 
                                    id="table-display-name" 
                                    class="form-input" 
                                    placeholder="e.g., Receipts, Contracts, Quotes"
                                    required
                                >
                                <small class="help-text">This is how your table will appear in the navigation</small>
                            </div>
                        </div>

                        <!-- Fields Definition Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h3>Field Definitions</h3>
                                <button type="button" id="add-field-btn" class="btn btn-secondary">
                                    <span class="material-icons" style="font-size: 1rem; margin-right: 8px;">add</span>Add Field
                                </button>
                            </div>
                            
                            <div id="fields-container">
                                <!-- Initial field will be added here -->
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <button type="button" id="cancel-table-creation" class="btn btn-secondary">Cancel</button>
                            <button type="submit" id="save-table-btn" class="btn btn-primary">
                                <span class="material-icons" style="font-size: 1rem; margin-right: 8px;">save</span>Create Table
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Generic Custom Table Template (will be cloned for each custom table) -->
            <div id="generic-custom-table-template" class="page-content" style="display: none;">
                <div class="data-section">
                    <div class="data-header">
                        <h3 class="data-title"></h3>
                        <div class="data-controls">
                            <input type="text" class="search-box generic-search" placeholder="Search...">
                            <input type="text" class="search-box generic-date-range" placeholder="Select date range..." readonly style="width: 200px;">
                            <button type="button" class="btn btn-secondary generic-clear-btn" title="Clear Filters">Clear</button>
                            <div class="search-loading" style="display: none;">
                                <span class="loading-spinner"></span>
                            </div>
                            <button class="btn btn-accent generic-upload-to-table-btn" style="margin-right: 8px;">
                                <span class="material-icons">cloud_upload</span>
                                Upload
                            </button>
                            <button class="btn btn-primary generic-export-btn">Export Selected CSV</button>
                            
                            <!-- Table Management Dropdown (only for custom tables) -->
                            <div class="dropdown generic-table-management" style="display: none;">
                                <button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown">
                                    <span class="material-icons">settings</span>
                                    Manage Table
                                </button>
                                <div class="dropdown-menu">
                                    <button class="dropdown-item generic-edit-table-btn">
                                        <span class="material-icons">edit</span>
                                        Edit Table
                                    </button>
                                    <button class="dropdown-item generic-delete-table-btn" style="color: #dc3545;">
                                        <span class="material-icons">delete</span>
                                        Delete Table
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="table-container" id="generic-table-container">
                        <table class="data-table">
                            <thead>
                                <tr class="generic-table-header">
                                    <!-- Headers will be generated dynamically -->
                                </tr>
                            </thead>
                            <tbody class="generic-table-body">
                                <!-- Rows will be generated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Upload Page Content -->
            <div id="page-upload" class="page-content" style="display: none;">
                <div class="upload-container">
                    <h2>Upload Documents</h2>
                    <p>Use the upload button in the toolbar or drag and drop files to get started.</p>
                    <div class="upload-page-actions">
                        <button class="btn btn-primary" id="upload-page-button">
                            <span class="material-icons" style="vertical-align: middle; margin-right: 8px;">cloud_upload</span>Upload Documents
                        </button>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Upload Modal -->
    <div id="upload-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload Documents</h3>
                <button id="close-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Table Selection Dropdown -->
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="table-selector" style="display: block; margin-bottom: 8px; font-weight: 500; color: #374151;">Upload to Table:</label>
                    <select id="table-selector" class="search-box" style="width: 100%; padding: 8px 12px;">
                        <option value="">Select a table...</option>
                    </select>
                </div>
                
                <div id="drop-zone" class="drop-zone">
                    <p>Drag & drop files here, or click to select files</p>
                    <input type="file" id="file-input" multiple hidden>
                </div>
                <div id="file-preview-container">
                    <h4>Selected Files:</h4>
                    <ul id="file-preview-list">
                        <!-- File previews will be generated here by JavaScript -->
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button id="upload-btn" class="btn btn-primary">Upload Files</button>
            </div>
        </div>
    </div>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="edit-modal-title">Edit Record</h3>
                <button id="close-edit-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-form">
                    <div id="edit-form-fields">
                        <!-- Form fields will be dynamically generated here -->
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-edit-btn" class="btn btn-secondary">Cancel</button>
                <button type="button" id="save-changes-btn" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3>Confirm Delete</h3>
                <button id="close-delete-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p id="delete-message">Are you sure you want to delete this record? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-delete-btn" class="btn btn-secondary">Cancel</button>
                <button type="button" id="confirm-delete-btn" class="btn btn-danger">Confirm Delete</button>
            </div>
        </div>
    </div>

    <!-- Edit Table Modal -->
    <div id="edit-table-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3>Edit Table</h3>
                <button id="close-edit-table-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="edit-table-form">
                    <!-- Table Name Section -->
                    <div class="form-group">
                        <label for="edit-table-name">Table Name *</label>
                        <input type="text" id="edit-table-name" class="form-input" required>
                    </div>

                    <!-- Columns Section -->
                    <div class="form-group">
                        <label>Columns</label>
                        <div id="edit-columns-container">
                            <!-- Column fields will be dynamically generated here -->
                        </div>
                        <button type="button" id="add-column-btn" class="btn btn-secondary" style="margin-top: 10px;">
                            <span class="material-icons">add</span>
                            Add Column
                        </button>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-edit-table-btn" class="btn btn-secondary">Cancel</button>
                <button type="button" id="save-table-changes-btn" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Delete Table Confirmation Modal -->
    <div id="delete-table-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 style="color: #dc3545;">Delete Table</h3>
                <button id="close-delete-table-modal-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 20px;">
                    <span class="material-icons" style="font-size: 4rem; color: #dc3545;">warning</span>
                </div>
                <p id="delete-table-message" style="text-align: center; font-weight: 500; margin-bottom: 15px;">
                    Are you sure you want to delete this table?
                </p>
                <div style="background: #fef2f2; border: 1px solid #fecaca; border-radius: 6px; padding: 15px; margin-bottom: 20px;">
                    <p style="color: #991b1b; margin: 0; font-size: 14px;">
                        <strong>Warning:</strong> This will permanently delete:
                    </p>
                    <ul style="color: #991b1b; margin: 8px 0 0 20px; font-size: 14px;">
                        <li>The table structure and configuration</li>
                        <li>All data in this table (cannot be recovered)</li>
                        <li>The table from your navigation menu</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label for="confirm-table-name">Type the table name to confirm:</label>
                    <input type="text" id="confirm-table-name" class="form-input" placeholder="Enter table name">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-delete-table-btn" class="btn btn-secondary">Cancel</button>
                <button type="button" id="confirm-delete-table-btn" class="btn btn-danger" disabled>Delete Table</button>
            </div>
        </div>
    </div>

    <script>console.log('ðŸ”¥ CANARY: About to load app.js module...');</script>
    <script type="module" src="app.js"></script>
    <script type="module" src="customTable.js"></script>
</body>
</html>